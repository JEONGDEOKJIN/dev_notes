# doing

## 서재원 개발자님 코드 검토

### 1. 이론적으로 어떻게 해야 하는지는 알겠다. 그런데 실제로 적용하는 단계에서, 이렇게 까지 만들어내지 못 했다. 나는 어떤 부분에서 몰랐던 걸까?

![Image](https://i.imgur.com/7ZowC6d.jpeg)

### 2. 상기해보자

```bash
- 서재원 개발자님은 '하나의 컴포넌트가 맡게 되는 역할을 최소화(?)' 해야 한다는 원칙을 자주 말씀 하셨다. (단일 책임 원칙?)

- 기억에 남는 것은
    1) 이 컴포넌트가 하는 역할이, 'page 레벨' 에서 봤을 때, '상태 데이터'를 '보고 받는 역할' 이고, '보고만 받으면 된다.'
        1-1) 자신의 역할이 아닌, '스타일 제어' 등은, page 레벨에서 보이면 안 된다.
        1-2) 다른 레벨에서 잘 만들어줬겠거니, 라고 생각하면 된다.
        1-3) 만약, '스타일' 에서 문제가 생긴다면, 보고를 받는 역할인 page 에 가서 뒤지는게 아니라, style 파일에 가서 디버깅을 해야 한다.

- 위의 경우를 바탕으로 생각해보면,
    1) 각 page, page의 components, 공통 compoenents 폴더, style 파일 및 파일의 위치, 에 대해서 명확히 고려할 필요가 있다.

    2) 그러면, 내가 이 파일을 분석한다고 했을 때 해야하는 것은
        2-1) table 을 만들어서, '어떤 레벨' 로 나눌 것인지를 정하고
        2-2) 신재원 개발자님 코드를 보면서 '각 레벨별 역할' 을 추측 해본다.
        2-3) 내가 기존에 작성했던 코드에서는, 이러한 '역할 배분' 에 대한 정책이 존재했는지, 막연하게 알고만 있었다면, 이게 왜 적극적으로 반영이 안 되었는지.
        2-4) 그 결과, '역할 배분이 고려 되지 않은 결과, 어떤 코드가 작성되는지'
        2-5) 그러면, 앞으로 '역할 배분' 을 어떻게 적용해나갈 것 인지. 이러한 이론을 적용하는데 있어서, 분명, 한계점이 있을텐데

-> 그러면 하나씩 해나가 보자

```

<br>

### 3. 프로젝트를 어떤 레벨로 나눌 수 있나?

1. 뭐라고 불러야 할지 모르겠지만, 프로젝트 셋팅단위 레벨

```bash
main.tsx
    | --- App.tsx
                | --- AppRouter 
                                1) 라우터 기능
                                2) 'URL 주소' 와 'page' 가 '연결' 되어 있음.

                        | --- page 
                            1) 이벤트를 주입 해줌 
                            2) style 을 주입함
                            3) 각 component 를 import 함
                            4) import 된 component 의 layout 을 잡아줌 (오와열, 간격, 등)
                            5) 사용자 interaction 정의 및 주입

                            | --- page 안에 있는 component
                                1) 부모의 주입없이, 독자적으로, data 를 확보할 수 있어야 함 (#contextAPI 활용?)
                                    - 이 level에서 data 에 접근할 수 있음 ⭐⭐⭐⭐⭐ | 왜냐면, children 에 속하기 때문에 
                                    
                                2) interaction 와 context 데이터를 '공통 컴포넌트에 연결' 
                                

                            | --- 공통 component
                                1) 여기에도, useFormContext<T> 가 존재함 
                                    -> 이게 어떤 역할을 하는 걸까? 
                                2) data 를 빼고, 돌아가는 건가? 이걸 사용할 때, useFormContext 안에 데이터를 넣어야 하는 건가? 


```

2. '데이터' 관점에서 page 레벨을 다시 


3. index.tsx 안에서 벌어지는 코드 흐름
1) zod 로 schema 를 생성 
```bash
schema 생성 구성 요소
1) 타입 
2) 필수 vs 선택 여부 
3) 유효성 
```

5) 유효성 검사를 다 통과해서 onValid 이면 -> "/register/info?agreement=y" 로 이동 
``` bash 
누가, 어떻게, onValid 라고 알려주는거지? 
```

<br>


4. 자식 컴포넌트의 상태를 받아서 confirm 버튼이 on/off 되는 로직 ⭐⭐⭐ 

``` bash 
1. RHForm 의 children 으로 있으면,
자식 컴포넌트들은, 
RHForm 이 갖고 있는 form context 객체에 접근할 수 있음 

2. 'form context 객체' 에 접근하면 
    -> form 필드의 값을 가져올 수 있고 
    -> 값을 활용하는 메서드에 접근할 수 있게 됨 

3. 이때, 구분해서 생각해볼 것은 '부모 컴포넌트' 관점과 '자식 컴포넌트' 관점임. 

    3.1 자식 컴포넌트 
        - 'useFormContext<AgreementFormType>' 을 사용하면, 
            - 부모 컴포넌트에서의 값을 받아올 수 있고, 
            - 자식 컴포넌트가 부모에게 상태값을 전달할 수도 있음.

    3.2 부모 컴포넌트 
        - 부모 컴포넌트는, 해당 form context 객체를 공유하고 싶은 자식 컴포넌트를 children 으로 묶으면 됨

4. 나아가서, 로직을 다른 곳에도 적용을 하면,
    - react form 을 쓰는게 아닌 상황에서 
    - 자식 컴포넌트가 부모 컴포넌트에게 상태값을 전달해야 하는 경우 ex) 모달창을 열 때! 
    - 이때, contextAPI 를 써야 되는 건가? ❓❓❓❓❓❓ 

    4.1 만약, 이게 맞다면, 'flux' 패턴이 지켜지는 거지? 
        - 왜냐면, 자식 컴포넌트가 전달을 안 하니까? 
        - 근데, 자식 컴포넌트 안에서도, useFormContext 안에서 setValue 를 꺼내서 사용하는 거면, 자식 컴포넌트가 부모 컴포넌트에게 전달하는거 아닌가? 

```


<br>



### 5. 회원가입을, 내가 다시 리팩토링 해봐야 제대로 익힐 수 있을 것 같다. 그 다음 storybook 에 api 까지 붙일 수 있으면 좋겠다. 우선, 회원가입을 이 기준으로 다시 리팩토링 해보자. 